.TH libssh2_agent_sign 3 "20 Apr 2023" "libssh2 1.11.0" "libssh2 manual"
.SH NAME
libssh2_agent_sign - sign specified bytes with specified agent.
.SH SYNOPSIS
.nf
#include <libssh2.h>

int
libssh2_agent_sign(LIBSSH2_AGENT *agent,
                   const unsigned char *data,
                   size_t data_len,
                   unsigned char **sig,
                   size_t *sig_len);
.fi
.SH DESCRIPTION
Generates signature for specified data with specified agent.

\fIagent\fP - Agent instance as returned by
.BR libssh2_agent_init(3)

\fIdata\fP - Some bytes that need to be signed.

\fIdata_len\fP - Length of the byte array.

\fIsig\fP - The signature that will be generated by the agent. It must be deallocated with
.BR libssh2_free(3)

\fIsig_len\fP - Length of the signature.

.SH RETURN VALUE
Returns 0 if succeeded, or a negative value for error.
.SH EXAMPLE
.nf
struct libssh2_agent_publickey* ident = NULL, identPrev = NULL;
while(libssh2_agent_get_identity(agent, &ident, identPrev) == 0) {
    unsigned char* sig = NULL;
    size_t len = 0;
    int code;

    libssh2_agent_userauth(agent, username, ident);

    code = libssh2_agent_sign(agent, data, data_len, &sig, &len);
    if(code)
        goto err;

    /* do_something(sig, len); */
    libssh2_free(session, sig);

    identPrev = ident;
}
.fi

.SH AVAILABILITY
Added in libssh2 1.11.0
.SH SEE ALSO
.BR libssh2_agent_init(3)
.BR libssh2_agent_get_identity(3)
.BR libssh2_agent_userauth(3)
.BR libssh2_free(3)
